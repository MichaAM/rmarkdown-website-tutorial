---
title: "Thesis Results Updated"
author:  "Micha A."
output:
  html_document:
    fig_width: 1
---

----

```{r echo=FALSE}
setwd("C:/Users/user/Documents/GitHub/rmarkdown-website-tutorial")
finald <- read.csv("finald.csv")
```



### Load R packages 

```{r include=FALSE}
library(sandwich)
library(lmtest)
library(stargazer)
library(estimatr)
library(texreg)
library(tidyverse)
library(plm)
library(lfe)
library(estimatr)
```


## Introduction
The panel data is clustered by 1069 schools. Schools were observed between 2008-2009, before the start of the program and in 2015-2016 after the end of the program. 


Schools were divided into sectors as follows:
```{r echo=FALSE}
table(finald$CODE_MIGZAR)
```
"0" - Jewish sector
"1" _ Arabic sector


Schools were divided by years and sectors as follows:
```{r echo=FALSE}
table(finald$CODE_MIGZAR, finald$SHNAT_LIMUD)
```

Schools were divided by treatment as follows:
```{r echo=FALSE}
table(finald$treat)
```



```{r echo=FALSE}
str(finald)
```

# Number of schools observed in the 2 periods - Before and after the treatment  
```{r echo=FALSE}
length(unique(finald$CODE_MOSAD))
```

## Balancing test for general sample 

![](images/General.png)

<br> 


# Anlalysis by sectors - Jewish("0") vs Arab("1") 

## Balancing test general sample 

![](images/Jewish sector.png)

<br> 

![](images/Arab sector.png)

<br> 


### Obsevations by sectores table 
```{r echo=FALSE}
table(finald$CODE_MIGZAR)
```


### Split the data by sectores
```{r echo=FALSE}
final_df_jew <- finald %>%
  filter(CODE_MIGZAR == "0") 
final_df_arb <- finald %>%
  filter(CODE_MIGZAR == "1") 
```


## DiD regression with clustered SE - Jewish sector
```{r echo=FALSE}
didreg.heb.jew <- lm_robust(heb.zscore ~ treat + after + did,
                        data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE - Arab sector
```{r echo=FALSE}
didreg.arb.arb <- lm_robust(arb.zscore ~ treat + after + did,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.arb <- lm_robust(mat.zscore ~ treat + after + did,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.arb <- lm_robust(eng.zscore ~ treat + after + did,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
```



Combined sector General DiD results
```{r echo=FALSE}
screenreg(list(didreg.heb.jew, didreg.mat.jew, didreg.eng.jew, didreg.arb.arb, didreg.mat.arb, didreg.eng.arb),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```




## DiD regression with clustered SE + Fixed effects - Jewish sector
```{r include=FALSE}
didreg.heb.jew.fe <- lm_robust(heb.zscore ~ did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE + Fixed effects - Arabic sector
```{r include=FALSE}
didreg.arb.arb.fe <- lm_robust(arb.zscore ~ did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.arb.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.arb.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata")
```



Combined sector General DiD results + Fixed effects 
```{r echo=FALSE}
screenreg(list(didreg.heb.jew.fe, didreg.mat.jew.fe, didreg.eng.jew.fe, didreg.arb.arb.fe, didreg.mat.arb.fe, didreg.eng.arb.fe),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```


## DiD regression with clustered SE + Fixed effects + additional variables - Jewish sector
```{r echo=FALSE}
didreg.heb.fe.var.jew <- lm_robust(heb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.jew <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.jew <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final_df_jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```



## DiD regression with clustered SE + Fixed effects + additional variables - Arabic sector
```{r include=FALSE}
didreg.arb.fe.var.arb <- lm_robust(arb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                     dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR+ MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                                   data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.arb <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                     dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                                   data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.arb <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                     dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                                   data = final_df_arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```


Combined sector General DiD results + Fixed effects 
```{r echo=FALSE}
screenreg(list(didreg.heb.fe.var.jew, didreg.mat.fe.var.jew, didreg.eng.fe.var.jew, didreg.arb.fe.var.arb, didreg.mat.fe.var.arb, didreg.eng.fe.var.arb),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01),
          custom.coef.map = list("did" = "Diff-in-Diff", "CODE_MIN" = "Sex", "SHNOT_LIMUD_AV" = "Father's years of education",
                                 "SHNOT_LIMUD_EM" = "Mother's years of education","erets_leda_ISR" = "Native indicator",
                                 "MISPAR_ACHIM" = "Number of siblings" ,"SES_index" = "SES index",
                                  "mean_kids_per_class_by_school_year" = "Class size"),
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```



# DiD regression by regions - periphery vs rest
Because almost all observation in the north and south regions took part in the program, I will check only the difference in the 
other regions. 

![](images/Not Periphery - jewish sector.png)

<br> 


### Split the data by regions periphery ("0") and rest ("1") 
```{r echo=FALSE}
final.df_periphery <- finald %>%
  filter(mahoz_ind == "1")
final.df_rest <- finald %>%
  filter(mahoz_ind == "0")
```


### Split final.df_rest by sector
```{r echo=FALSE}
final.df_rest.jew <- final.df_rest %>%
  filter(CODE_MIGZAR == "0")
final.df_rest.arb <- final.df_rest %>%
  filter(CODE_MIGZAR == "1")
```


### Table of observations per region 
```{r echo=FALSE}
region_tbl <- table(finald$mahoz_ind)
names(region_tbl)[1]<-paste("Periphery")
names(region_tbl)[2]<-paste("Rest")
region_tbl

```

### Table of observations per region per sector 
```{r echo=FALSE}
region_sectore_table <- table(finald$mahoz_ind, finald$CODE_MIGZAR)
rownames(region_sectore_table) <- c("Periphery", "Rest" )
colnames(region_sectore_table) <- c("Jewish", "Arab" )
region_sectore_table
```

# Simple DiD regression on rest regions by sectores 

### DiD regression with clustered SE - rest regions - Jewish sector only
```{r echo=FALSE}
didreg.heb.jew.rest <- lm_robust(heb.zscore ~ treat + after + did,
                        data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew.rest <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew.rest <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE - rest regions - Arab sector only
```{r echo=FALSE}
didreg.arb.arb.rest <- lm_robust(arb.zscore ~ treat + after + did,
                        data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.arb.rest <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.arb.rest <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.jew.rest, didreg.mat.jew.rest, didreg.eng.jew.rest, didreg.arb.arb.rest, didreg.mat.arb.rest, didreg.eng.arb.rest),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```

# DiD regression with clustered SE + Fixed effects

## DiD regression with clustered SE + Fixed effects - Jewish sector
```{r include=FALSE}
didreg.heb.rest.jew.fe <- lm_robust(heb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.rest.jew.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.rest.jew.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE + Fixed effects - Arab sector
```{r include=FALSE}
didreg.arb.rest.arb.fe <- lm_robust(arb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.rest.arb.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.rest.arb.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results + Fixed effects - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.rest.jew.fe, didreg.mat.rest.jew.fe, didreg.eng.rest.jew.fe, didreg.arb.rest.arb.fe, didreg.mat.rest.arb.fe, didreg.eng.rest.arb.fe),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```



# DiD regression with clustered SE + Fixed effects + additional variables 


## DiD regression with clustered SE + Fixed effects + additional variables - Jewish sector
```{r include=FALSE}
didreg.heb.fe.var.jew.rest <- lm_robust(heb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.jew.rest <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.jew.rest <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```


## DiD regression with clustered SE + Fixed effects + additional variables - Arab sector
```{r include=FALSE}
didreg.arb.fe.var.arb.rest <- lm_robust(arb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.arb.rest <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.arb.rest <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM + SES_index, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df_rest.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```



Combined sector General DiD results + Fixed effects + Aditional vars - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.fe.var.jew.rest, didreg.mat.fe.var.jew.rest, didreg.eng.fe.var.jew.rest, didreg.arb.fe.var.arb.rest, didreg.mat.fe.var.arb.rest, didreg.eng.fe.var.arb.rest),
          custom.coef.map = list("did" = "Diff-in-Diff", "CODE_MIN" = "Sex", "SHNOT_LIMUD_AV" = "Father's years of education",
                                 "SHNOT_LIMUD_EM" = "Mother's years of education","erets_leda_ISR" = "Native indicator",
                                 "MISPAR_ACHIM" = "Number of siblings" ,"SES_index" = "SES index",
                                  "mean_kids_per_class_by_school_year" = "Class size"),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))

```


### SES index analysis

# Split SES index to 3 levels index. 

```{r}
final.df.elion <- finald %>%
  filter(SES_index <= 4)
final.df.emtsae <- finald %>%
  filter(SES_index > 4 & SES_index <= 7)
final.df.tahton <- finald %>%
  filter(SES_index > 7)
```

# Split thirds by sector

```{r}
final.df.elion.jew <- final.df.elion %>%
  filter(CODE_MIGZAR == "0")
final.df.elion.arb <- final.df.elion %>%
  filter(CODE_MIGZAR == "1")

final.df.emtsae.jew <- final.df.emtsae %>%
  filter(CODE_MIGZAR == "0")
final.df.emtsae.arb <- final.df.emtsae %>%
  filter(CODE_MIGZAR == "1")

final.df.tahton.jew <- final.df.tahton %>%
  filter(CODE_MIGZAR == "0")
final.df.tahton.arb <- final.df.tahton %>%
  filter(CODE_MIGZAR == "1")

```


# Analysis of top Upper third  
#############################################

## Simple DiD regression   

### DiD regression with clustered SE  - Jewish sector only
```{r echo=FALSE}
didreg.heb.jew.elion <- lm_robust(heb.zscore ~ treat + after + did,
                        data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew.elion <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew.elion <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results - Rest of israel by sectors 
```{r echo=FALSE, message=FALSE, warning=FALSE}
screenreg(list(didreg.heb.jew.elion, didreg.mat.jew.elion, didreg.eng.jew.elion),
          custom.header = list("Jewish sector" = 1:3), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English"))
```

## DiD regression with clustered SE + Fixed effects

## DiD regression with clustered SE + Fixed effects - Jewish sector
```{r include=FALSE}
didreg.heb.elion.jew.fe <- lm_robust(heb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.elion.jew.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.elion.jew.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results + Fixed effects - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.elion.jew.fe, didreg.mat.elion.jew.fe, didreg.eng.elion.jew.fe),
          custom.header = list("Jewish sector" = 1:3), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English"))
```

# DiD regression with clustered SE + Fixed effects + additional variables 


## DiD regression with clustered SE + Fixed effects + additional variables - Jewish sector
```{r include=FALSE}
didreg.heb.fe.var.jew.elion <- lm_robust(heb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.jew.elion <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.jew.elion <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.elion.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```


Combined sector General DiD results + Fixed effects + Additional vars 
```{r echo=FALSE}
screenreg(list(didreg.heb.fe.var.jew.elion, didreg.mat.fe.var.jew.elion, didreg.eng.fe.var.jew.elion),
          custom.coef.map = list("did" = "Diff-in-Diff", "CODE_MIN" = "Sex", "SHNOT_LIMUD_AV" = "Father's years of education",
                                 "SHNOT_LIMUD_EM" = "Mother's years of education","erets_leda_ISR" = "Native indicator",
                                 "MISPAR_ACHIM" = "Number of siblings" ,
                                  "mean_kids_per_class_by_school_year" = "Class size"),
          custom.header = list("Jewish sector" = 1:3), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English"))

```

# Analysis of top Middle third  
#############################################

# DiD regression with clustered SE 

## DiD regression with clustered SE - rest regions - Jewish sector only
```{r echo=FALSE}
didreg.heb.jew.emtsae <- lm_robust(heb.zscore ~ treat + after + did,
                        data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew.emtsae <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew.emtsae <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE - rest regions - Arab sector only
```{r echo=FALSE}
didreg.arb.arb.emtsae <- lm_robust(arb.zscore ~ treat + after + did,
                        data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.arb.emtsae <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.arb.emtsae <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.jew.emtsae, didreg.mat.jew.emtsae, didreg.eng.jew.emtsae, didreg.arb.arb.emtsae, didreg.mat.arb.emtsae, didreg.eng.arb.emtsae),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```


# DiD regression with clustered SE + Fixed effects

## DiD regression with clustered SE + Fixed effects - Jewish sector
```{r include=FALSE}
didreg.heb.emtsae.jew.fe <- lm_robust(heb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.emtsae.jew.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.emtsae.jew.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE + Fixed effects - Arab sector
```{r include=FALSE}
didreg.arb.emtsae.arb.fe <- lm_robust(arb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.emtsae.arb.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.emtsae.arb.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results + Fixed effects - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.emtsae.jew.fe, didreg.mat.emtsae.jew.fe, didreg.eng.emtsae.jew.fe, didreg.arb.emtsae.arb.fe, didreg.mat.emtsae.arb.fe, didreg.eng.emtsae.arb.fe),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```

## DiD regression with clustered SE + Fixed effects + additional variables - Jewish sector
```{r include=FALSE}
didreg.heb.fe.var.jew.emtsae <- lm_robust(heb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.jew.emtsae <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.jew.emtsae <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```


## DiD regression with clustered SE + Fixed effects + additional variables - Arab sector
```{r include=FALSE}
didreg.arb.fe.var.arb.emtsae <- lm_robust(arb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.arb.emtsae <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.arb.emtsae <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.emtsae.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```



Combined sector General DiD results + Fixed effects + Aditional vars - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.fe.var.jew.emtsae, didreg.mat.fe.var.jew.emtsae, didreg.eng.fe.var.jew.emtsae, didreg.arb.fe.var.arb.emtsae, didreg.mat.fe.var.arb.emtsae, didreg.eng.fe.var.arb.emtsae),
          custom.coef.map = list("did" = "Diff-in-Diff", "CODE_MIN" = "Sex", "SHNOT_LIMUD_AV" = "Father's years of education",
                                 "SHNOT_LIMUD_EM" = "Mother's years of education","erets_leda_ISR" = "Native indicator",
                                 "MISPAR_ACHIM" = "Number of siblings" ,"SES_index" = "SES index",
                                  "mean_kids_per_class_by_school_year" = "Class size"),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))

```

# Analysis of top Lower third  
#############################################

# DiD regression with clustered SE 

## DiD regression with clustered SE - rest regions - Jewish sector only
```{r echo=FALSE}
didreg.heb.jew.tahton <- lm_robust(heb.zscore ~ treat + after + did,
                        data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.jew.tahton <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.jew.tahton <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE - rest regions - Arab sector only
```{r echo=FALSE}
didreg.arb.arb.tahton <- lm_robust(arb.zscore ~ treat + after + did,
                        data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.arb.tahton <- lm_robust(mat.zscore ~ treat + after + did,
                        data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.arb.tahton <- lm_robust(eng.zscore ~ treat + after + did,
                        data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.jew.tahton, didreg.mat.jew.tahton, didreg.eng.jew.tahton, didreg.arb.arb.tahton, didreg.mat.arb.tahton, didreg.eng.arb.tahton),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```


# DiD regression with clustered SE + Fixed effects

## DiD regression with clustered SE + Fixed effects - Jewish sector
```{r include=FALSE}
didreg.heb.tahton.jew.fe <- lm_robust(heb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.tahton.jew.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.tahton.jew.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata")
```


## DiD regression with clustered SE + Fixed effects - Arab sector
```{r include=FALSE}
didreg.arb.tahton.arb.fe <- lm_robust(arb.zscore ~  did, fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.mat.tahton.arb.fe <- lm_robust(mat.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
didreg.eng.tahton.arb.fe <- lm_robust(eng.zscore ~  did,fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                            data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata")
```


Combined sector General DiD results + Fixed effects - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.tahton.jew.fe, didreg.mat.tahton.jew.fe, didreg.eng.tahton.jew.fe, didreg.arb.tahton.arb.fe, didreg.mat.tahton.arb.fe, didreg.eng.tahton.arb.fe),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))
```


## DiD regression with clustered SE + Fixed effects + additional variables - Jewish sector
```{r include=FALSE}
didreg.heb.fe.var.jew.tahton <- lm_robust(heb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.jew.tahton <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.jew.tahton <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.jew, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```


## DiD regression with clustered SE + Fixed effects + additional variables - Arab sector
```{r include=FALSE}
didreg.arb.fe.var.arb.tahton <- lm_robust(arb.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR  + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.mat.fe.var.arb.tahton <- lm_robust(mat.zscore ~ did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)
didreg.eng.fe.var.arb.tahton <- lm_robust(eng.zscore ~  did + CODE_MIN + SHNOT_LIMUD_AV + SHNOT_LIMUD_EM + dummy_av_88 + 
                                 dummy_em_88 + mean_kids_per_class_by_school_year + erets_leda_ISR + MISPAR_ACHIM , fixed_effects = ~CODE_MOSAD+SHNAT_LIMUD,
                               data = final.df.tahton.arb, clusters = CODE_MOSAD, se_type = "stata", try_cholesky = TRUE)

```



Combined sector General DiD results + Fixed effects + Aditional vars - Rest of israel by sectors 
```{r echo=FALSE}
screenreg(list(didreg.heb.fe.var.jew.tahton, didreg.mat.fe.var.jew.tahton, didreg.eng.fe.var.jew.tahton, didreg.arb.fe.var.arb.tahton, didreg.mat.fe.var.arb.tahton, didreg.eng.fe.var.arb.tahton),
          custom.coef.map = list("did" = "Diff-in-Diff", "CODE_MIN" = "Sex", "SHNOT_LIMUD_AV" = "Father's years of education",
                                 "SHNOT_LIMUD_EM" = "Mother's years of education","erets_leda_ISR" = "Native indicator",
                                 "MISPAR_ACHIM" = "Number of siblings" ,
                                  "mean_kids_per_class_by_school_year" = "Class size"),
          custom.header = list("Jewish sector" = 1:3,  "Arab sector" = 4:6), include.ci = F, stars = c(.1, .05, .01), 
          digits = 3, custom.model.names = c("Hebrew", "Math", "English", "Arabic", "Math", "English"))

```




